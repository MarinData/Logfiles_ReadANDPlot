% Needs the variable seaB1 to work

i=320
plot3(seaB1(1,i),seaB1(2,i),-seaB1(3,i),'ro')
hold on
plot3(seaB2(1,i),seaB2(2,i),-seaB2(3,i),'ro')
plot3(seaB3(1,i),seaB3(2,i),-seaB3(3,i),'ro')
plot3(seaB4(1,i),seaB4(2,i),-seaB4(3,i),'ro')
seaB_line=[seaB1(1,i),seaB1(2,i),seaB1(3,i);
           seaB2(1,i),seaB2(2,i),seaB2(3,i);
           seaB3(1,i),seaB3(2,i),seaB3(3,i);
           seaB4(1,i),seaB4(2,i),seaB4(3,i)];
i=500
plot3(seaB1(1,i),seaB1(2,i),-seaB1(3,i),'ro')
plot3(seaB2(1,i),seaB2(2,i),-seaB2(3,i),'ro')
plot3(seaB3(1,i),seaB3(2,i),-seaB3(3,i),'ro')
plot3(seaB4(1,i),seaB4(2,i),-seaB4(3,i),'ro')
seaB_line=[seaB_line;
           seaB1(1,i),seaB1(2,i),seaB1(3,i);
           seaB2(1,i),seaB2(2,i),seaB2(3,i);
           seaB3(1,i),seaB3(2,i),seaB3(3,i);
           seaB4(1,i),seaB4(2,i),seaB4(3,i)];

i=750
plot3(seaB1(1,i),seaB1(2,i),-seaB1(3,i),'ro')
plot3(seaB2(1,i),seaB2(2,i),-seaB2(3,i),'ro')
plot3(seaB3(1,i),seaB3(2,i),-seaB3(3,i),'ro')
plot3(seaB4(1,i),seaB4(2,i),-seaB4(3,i),'ro')
seaB_line=[seaB_line;
           seaB1(1,i),seaB1(2,i),seaB1(3,i);
           seaB2(1,i),seaB2(2,i),seaB2(3,i);
           seaB3(1,i),seaB3(2,i),seaB3(3,i);
           seaB4(1,i),seaB4(2,i),seaB4(3,i)];



i=1200
plot3(seaB1(1,i),seaB1(2,i),-seaB1(3,i),'ro')
plot3(seaB2(1,i),seaB2(2,i),-seaB2(3,i),'ro')
plot3(seaB3(1,i),seaB3(2,i),-seaB3(3,i),'ro')
plot3(seaB4(1,i),seaB4(2,i),-seaB4(3,i),'ro')
seaB_line=[seaB_line;
           seaB1(1,i),seaB1(2,i),seaB1(3,i);
           seaB2(1,i),seaB2(2,i),seaB2(3,i);
           seaB3(1,i),seaB3(2,i),seaB3(3,i);
           seaB4(1,i),seaB4(2,i),seaB4(3,i)];

i=1450
plot3(seaB1(1,i),seaB1(2,i),-seaB1(3,i),'ro')
plot3(seaB2(1,i),seaB2(2,i),-seaB2(3,i),'ro')
plot3(seaB3(1,i),seaB3(2,i),-seaB3(3,i),'ro')
plot3(seaB4(1,i),seaB4(2,i),-seaB4(3,i),'ro')
seaB_line=[seaB_line;
           seaB1(1,i),seaB1(2,i),seaB1(3,i);
           seaB2(1,i),seaB2(2,i),seaB2(3,i);
           seaB3(1,i),seaB3(2,i),seaB3(3,i);
           seaB4(1,i),seaB4(2,i),seaB4(3,i)];

i=1640
plot3(seaB1(1,i),seaB1(2,i),-seaB1(3,i),'ro')
plot3(seaB2(1,i),seaB2(2,i),-seaB2(3,i),'ro')
plot3(seaB3(1,i),seaB3(2,i),-seaB3(3,i),'ro')
plot3(seaB4(1,i),seaB4(2,i),-seaB4(3,i),'ro')

i=1800
plot3(seaB1(1,i),seaB1(2,i),-seaB1(3,i),'ro')
plot3(seaB2(1,i),seaB2(2,i),-seaB2(3,i),'ro')
plot3(seaB3(1,i),seaB3(2,i),-seaB3(3,i),'ro')
plot3(seaB4(1,i),seaB4(2,i),-seaB4(3,i),'ro')
seaB_line=[seaB_line;
           seaB1(1,i),seaB1(2,i),seaB1(3,i);
           seaB2(1,i),seaB2(2,i),seaB2(3,i);
           seaB3(1,i),seaB3(2,i),seaB3(3,i);
           seaB4(1,i),seaB4(2,i),seaB4(3,i)];

i=1990
plot3(seaB1(1,i),seaB1(2,i),-seaB1(3,i),'ro')
plot3(seaB2(1,i),seaB2(2,i),-seaB2(3,i),'ro')
plot3(seaB3(1,i),seaB3(2,i),-seaB3(3,i),'ro')
plot3(seaB4(1,i),seaB4(2,i),-seaB4(3,i),'ro')
seaB_line=[seaB_line;
           seaB1(1,i),seaB1(2,i),seaB1(3,i);
           seaB2(1,i),seaB2(2,i),seaB2(3,i);
           seaB3(1,i),seaB3(2,i),seaB3(3,i);
           seaB4(1,i),seaB4(2,i),seaB4(3,i)];

i=2150
plot3(seaB1(1,i),seaB1(2,i),-seaB1(3,i),'ro')
plot3(seaB2(1,i),seaB2(2,i),-seaB2(3,i),'ro')
plot3(seaB3(1,i),seaB3(2,i),-seaB3(3,i),'ro')
plot3(seaB4(1,i),seaB4(2,i),-seaB4(3,i),'ro')
seaB_line=[seaB_line;
           seaB1(1,i),seaB1(2,i),seaB1(3,i);
           seaB2(1,i),seaB2(2,i),seaB2(3,i);
           seaB3(1,i),seaB3(2,i),seaB3(3,i);
           seaB4(1,i),seaB4(2,i),seaB4(3,i)];

plot3(EstStates(:,1),EstStates(:,2),-(EstStates(:,3)+EstStates(:,13)),'b','linewidth',1);



F=TriScatteredInterp(seaB_line(:,1),seaB_line(:,2),seaB_line(:,3),'linear');


%figure

tx = -15:.1:13;
ty = -25:.1:5;
[qx,qy] = meshgrid(tx,ty);
%[qx,qy] = meshgrid(seaB(1,1:10:9012),seaB(2,1:10:9012));
qz = F(qx,qy);
mesh(qx,qy,-qz);
axis equal
hidden off